name: Build RISC-V softmmu

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    # runs-on: self-hosted

    steps:
    - uses: actions/checkout@v2
      with:
          submodules: true
    - name: Checkout the proper submodule versions
      run: git submodule update --recursive &&
            git submodule status
    - name: Load Docker toolchain containers
      run: docker/bin/dock.sh /bin/true
    - name: Build project from Docker container
      run: docker/bin/dock.sh scripts/build.sh
                qemu-sifive_e_rv64 DEBUG
    - name: Build project from Docker container
      run: docker/bin/dock.sh scripts/build.sh
                qemu-sifive_e_rv64 RELEASE
    - name: Build project from Docker container
      run: docker/bin/dock.sh scripts/build.sh
                qemu-sifive_e_rv64 STATIC_ANALYSIS
